# Θεωρητικό Υπόβαθρο

## Βασικά Μοντέλα Επαφής

Παρακάτω παρουσιάζονται οι διάφορες μοντελοποιήσεις που ακολουθεί η έρευνα και η βιομηχανία ανά καιρούς για την αλληλεπίδραση τροχού-ράγας.

### Επαφή κατά Hertz (ελαστική μέθοδος)

#### Περιγραφή
Το 1882, εισήχθη μία θεωρία μοντελοποίησης της μηχανικής επαφής η οποία λαμβάνει υπόψη το σχήμα των επιφανειών στην περιοχή επαφής. Αυτή η θεωρία, γνωστή ως θεωρία του Hertz [1], είναι θεμελιώδης για την κατανόηση της επαφής τροχού-ράγας και έχει σημαντικές εφαρμογές στη μηχανική και τις μεταφορές.

#### Βασικές Υποθέσεις
- Συνεχείς και λείες επιφάνειες: Οι επιφάνειες είναι ακριβώς καθορισμένες γεωμετρικά (χωρίς τραχύτητα) και αρχικά εφάπτονται σε ένα σημείο (ή γραμμή για κυλινδρικές γεωμετρίες).
- Μικρές παραμορφώσεις: Η παραμόρφωση λόγω επαφής είναι πολύ μικρότερη από τις διαστάσεις των σωμάτων.
- Τοπική επίδραση: Η κατανομή τάσεων επηρεάζει μόνο μια μικρή περιοχή γύρω από το σημείο επαφής.
- Απουσία τριβής: Θεωρείται μόνο κανονική (normal) δύναμη, χωρίς διατμητικές τάσεις.
- Γραμμική ελαστικότητα: Τα υλικά υπακούουν στο νόμο του Hooke, χωρίς πλαστικές παραμορφώσεις.

#### Μαθηματικό Υπόβαθρο
Για την επαφή, οι δύο εξωτερικές επιφάνειες του τροχού και της ράγας προσεγγίζονται ως δύο ελλειψοειδή με ισοδύναμες ακτίνες, οι οποίες περιγράφονται από τις ακτίνες $R_{w}$, $R_{r}$. Οι ακτίνες καμπυλότητας στις δύο κάθετες διευθύνσεις ($x$, $y$) υπολογίζονται από:

$$\frac{1}{R_{x}} = \frac{1}{R_{1x}} + \frac{1}{R_{2x}},\quad\frac{1}{R_{y}} = \frac{1}{R_{1y}} + \frac{1}{R_{2y}}$$

όπου οι δείκτες 1 και 2 αφορούν τον τροχό και τη ράγα αντίστοιχα.

Το ισοδύναμο μέτρο ελαστικότητας των δύο σωμάτων δίνεται από:

$$\frac{1}{E^{*}} = \frac{1 - \nu_{1}^{2}}{E_{1}} + \frac{1 - \nu_{2}^{2}}{E_{2}}$$

όπου $E_{1}$, $E_{2}$ τα μέτρα ελαστικότητας και $\nu_{1}$, $\nu_{2}$ οι λόγοι Poisson.

Η περιοχή που υπόκειται σε φορτίο θεωρείται ότι αποτελεί μια μικρή ελλειπτική περιοχή. Το εμβαδόν της περιοχής επαφής δίνεται από:

$$A = \pi ab$$

όπου $a$ και $b$ είναι οι ημιάξονες της ελλειπτικής περιοχής επαφής. Οι ημιάξονες αυτοί υπολογίζονται από τις παρακάτω σχέσεις:

$$a = \left( \frac{3F_{N}R^{*}}{2E^{*}} \cdot \frac{1}{k} \right)^{1/3}$$
$$b = k \cdot a$$

όπου $F_{N}$ η κανονική δύναμη επαφής, $R^{*}$ η ισοδύναμη ακτίνα καμπυλότητας, $k$ ο λόγος των ημιάξονων, ο οποίος εξαρτάται από τις τοπικές ακτίνες καμπυλότητας.

Η μέγιστη πίεση στην περιοχή επαφής δίνεται από:

$$p_{0} = \frac{3F_{N}}{2\pi ab}$$

Η κατανομή της πίεσης μέσα στην περιοχή επαφής είναι ελλειπτική:

$$p(x,y) = p_{0}\sqrt{1 - \left( \frac{x}{a} \right)^{2} - \left( \frac{y}{b} \right)^{2}}$$

#### Οπτικό Υλικό
<figure>
<img src="media/image1.png" style="width:6.5in;height:2.48019in" alt="A diagram of a curved section AI-generated content may be incorrect." />
<figcaption>Εικόνα 2.1.1.1 Ορισμός ακτινών για τη μοντελοποίηση Hertz</figcaption>
</figure>

#### Πλεονεκτήματα
- Παρέχει αναλυτική λύση για το μέγεθος και τη θέση της περιοχής επαφής
- Πολύ γρήγορος και αποδοτικός υπολογισμός για απλές (σφαιρικές/ελλειπτικές) γεωμετρίες
- Χρησιμοποιείται ευρέως ως βάση για θεωρητικές και πρακτικές εφαρμογές τροχού-ράγας

#### Μειονεκτήματα
- Δεν εφαρμόζεται σε πολύπλοκες/ακανόνιστες γεωμετρίες
- Αγνοεί επιφανειακές ανωμαλίες και πολλαπλά σημεία επαφής
- Δεν λαμβάνει υπόψη τριβή ή διατμητικές τάσεις
- Δυναμική Μεταβολή Γεωμετρίας: Η κωνικότητα του τροχού και η καμπυλότητα της ράγας οδηγούν σε συνεχή μεταβολή των ισοδύναμων ακτίνων $R_{w}$, $R_{r}$ κατά τη διάρκεια κύλισης
- Απλοποιημένες Παραδοχές: Αγνοεί την τριβή και τις διατμητικές τάσεις, που είναι κρίσιμες για την ανάλυση creep

### Multi-Hertzian Μέθοδος

#### Περιγραφή
Για την αντιμετώπιση των περιορισμών της κλασικής θεωρίας του Hertz, χρησιμοποιείται η Multi-Hertzian μέθοδος (ή Discrete Multi-Hertzian approach), η οποία αποτελεί μια οργανωμένη προσέγγιση για τη μοντελοποίηση της διεπαφής τροχού-ράγας. Αυτή η μέθοδος είναι ιδιαίτερα χρήσιμη σε περιπτώσεις όπου οι γεωμετρίες των τροχών και των ραγών δεν είναι ομοιόμορφες ή παρουσιάζουν πολύπλοκες καμπυλότητες.

#### Μαθηματικό Υπόβαθρο
Η Multi-Hertzian μέθοδος χωρίζει την περιοχή επαφής σε πολλές υπο-περιοχές, καθεμία από τις οποίες έχει δικές της ακτίνες καμπυλότητας και τοπικό σύστημα συντεταγμένων. Σε κάθε υπο-περιοχή εφαρμόζεται ξεχωριστά η θεωρία του Hertz.

Για κάθε υποπεριοχή:
- Υπολογίζονται τοπικές ακτίνες $R_{xi}$, $R_{yi}$
- Υπολογίζεται τοπικό $E_{i}$
- Εφαρμόζονται οι τύποι Hertz για $a_{i}$, $b_{i}$, $p_{0,i}$

Η συνολική κατανομή πίεσης και η συνολική δύναμη προκύπτει από το άθροισμα των επιμέρους συμβολών:

$$F_{N,\text{συνολική}} = \sum_{i = 1}^{n}F_{N,i}$$

#### Πλεονεκτήματα
- Βελτιωμένη Ακρίβεια: Επιτρέπει την ακριβή μοντελοποίηση των μη-ομοιόμορφων γεωμετριών
- Δυνατότητα Ανάλυσης Πολυάριθμων Σημείων Επαφής
- Αξιολόγηση Φθοράς και Απόδοσης
- Προσαρμοστικότητα

#### Μειονεκτήματα
- Υψηλότερες υπολογιστικές απαιτήσεις λόγω της διακριτοποίησης των δύο επιφανειών
- Απαιτεί περισσότερους υπολογιστικούς πόρους και χρόνο για την ανάλυση

### Μοντελοποίηση επαφής με τη μέθοδο Lagrange

#### Περιγραφή
Η μέθοδος των πολλαπλασιαστών Lagrange (Lagrange multiplier method) εισήχθη για τη μοντελοποίηση της μηχανικής επαφής ως πρόβλημα περιορισμών. Αποτελεί θεμελιώδη αριθμητική προσέγγιση για την ανάλυση της επαφής μεταξύ σωμάτων, ιδίως σε εφαρμογές που απαιτούν υψηλή ακρίβεια, όπως η προσομοίωση της διεπαφής τροχού-ράγας με τη μέθοδο των πεπερασμένων στοιχείων (FEM).

#### Μαθηματικό Υπόβαθρο
Έστω ότι δύο σώματα $A$ και $B$ έρχονται σε επαφή. Για κάθε πιθανό σημείο επαφής $i$, ο περιορισμός μη διείσδυσης (non-penetration) εκφράζεται ως:

$$g_{i}(\mathbf{u}) \geq 0$$

όπου $g_{i}(\mathbf{u})$ είναι το κενό (gap) μεταξύ των επιφανειών, ως συνάρτηση των μετατοπίσεων.

Η επιβολή του περιορισμού γίνεται με την εισαγωγή πολλαπλασιαστή Lagrange $\lambda_{i}$, που φυσικά αντιπροσωπεύει τη δύναμη επαφής:

$$L(\mathbf{u},\mathbf{\lambda}) = \Pi(\mathbf{u}) + \sum_{i}^{}\lambda_{i}g_{i}(\mathbf{u})$$

όπου $L$: η επαυξημένη συνάρτηση Lagrange, $\Pi(\mathbf{u})$: το δυναμικό ενέργειας του συστήματος, $\lambda_{i}$: πολλαπλασιαστής Lagrange (δύναμη επαφής).

Η λύση προκύπτει από την απαίτηση στάσιμης τιμής της $L$:

$$\frac{\partial L}{\partial\mathbf{u}} = 0,\quad\frac{\partial L}{\partial\mathbf{\lambda}} = 0$$

Αυτό οδηγεί στο επαυξημένο (augmented) σύστημα εξισώσεων:

$$\begin{bmatrix}
\mathbf{K} & \mathbf{C}^{\mathbf{T}} \\
\mathbf{C} & \mathbf{0}
\end{bmatrix}\begin{bmatrix}
\mathbf{u} \\
\mathbf{\lambda}
\end{bmatrix}\mathbf{=}\begin{bmatrix}
\mathbf{F} \\
\mathbf{g}
\end{bmatrix}$$

όπου $K$: πίνακας ακαμψίας (stiffness matrix), $u$: διάνυσμα μετατοπίσεων, $C$: πίνακας περιορισμών επαφής, $\lambda$: διανύσμα πολλαπλασιαστών Lagrange (δυνάμεων επαφής), $F$: διανύσμα φορτίων, $g$: διανύσμα κενωμάτων.

Η μέθοδος μπορεί να επεκταθεί για την ταυτόχρονη επιβολή περιορισμών κανονικής και διατμητικής επαφής, επιτρέποντας την ανάλυση τριβής, micro-slip και creep.

#### Πλεονεκτήματα
- Υψηλή Ακρίβεια
- Γενίκευση σε Σύνθετες Γεωμετρίες
- Ευελιξία στη Μοντελοποίηση
- Αναλυτική Θεμελίωση

#### Μειονεκτήματα
- Υψηλότερη Υπολογιστική Πολυπλοκότητα
- Αυξημένες Απαιτήσεις Μνήμης
- Πιθανή Δυσκολία Σύγκλισης

### Μοντελοποίηση επαφής με τη χρήση Πεπερασμένων Στοιχείων (FEM)

#### Περιγραφή
Η μέθοδος των πεπερασμένων στοιχείων (Finite Element Method, FEM) αποτελεί μια αριθμητική τεχνική που χρησιμοποιείται για την προσομοίωση της συμπεριφοράς ελαστικών και πλαστικών σωμάτων υπό μηχανικές φορτίσεις. Στο πλαίσιο της μοντελοποίησης επαφής τροχού-ράγας, η FEM επιτρέπει την ανάλυση των δυνάμεων και των τάσεων που αναπτύσσονται τοπικά στην περιοχή επαφής, ακόμα και σε περιπτώσεις πολύπλοκων γεωμετριών ή ανομοιομορφιών στις επιφάνειες.

#### Μαθηματικό Υπόβαθρο
Το συνεχές σώμα διαχωρίζεται σε $N$ μικρά στοιχεία, καθένα από τα οποία ορίζεται από κόμβους (nodes). Για κάθε στοιχείο $e$, η μετατόπιση $u_{e}$ περιγράφεται μέσω συναρτήσεων σχήματος $N_{i}$:

$$u_{e}(x) = \sum_{i = 1}^{n}N_{i}(x)u_{i}$$

όπου $N_{i}(x)$ είναι η συνάρτηση σχήματος για τον κόμβο $i$ και $u_{i}$ η μετατόπιση του κόμβου $i$.

Η γενική εξίσωση ισορροπίας για το σύστημα, αγνοώντας δυναμικά φαινόμενα (quasi-static ανάλυση), δίνεται από:

$$\mathbf{Ku} = \mathbf{F}$$

όπου $\mathbf{K}$: παγκόσμιος πίνακας ακαμψίας (stiffness matrix), $\mathbf{u}$: διάνυσμα μετατοπίσεων όλων των κόμβων, $\mathbf{F}$: διάνυσμα εξωτερικών φορτίων.

Η επαφή μεταξύ δύο σωμάτων (τροχός-ράγα) εισάγεται ως ειδικός περιορισμός (contact constraint) στις συνοριακές συνθήκες. Για τη μέθοδο penalty, ο περιορισμός μη διείσδυσης (non-penetration) περιγράφεται από:

$$p_{n} = \kappa\, g_{n}^{-}$$

όπου $p_{n}$: κανονική δύναμη επαφής, $\kappa$: σταθερά penalty (μεγάλος αριθμός), $g_{n}^{-}$: αρνητικό μέρος του κενώματος (gap) μεταξύ των επιφανειών.

Στη γενική περίπτωση, η εξίσωση του συστήματος με συνθήκες επαφής γίνεται:

$$\begin{bmatrix}
\mathbf{K} & \mathbf{C}^{T} \\
\mathbf{C} & \mathbf{0}
\end{bmatrix}\begin{bmatrix}
\mathbf{u} \\
\mathbf{\lambda}
\end{bmatrix} = \begin{bmatrix}
\mathbf{F} \\
\mathbf{g}
\end{bmatrix}$$

όπου $\mathbf{C}$: πίνακας περιορισμών επαφής, $\mathbf{\lambda}$: διάνυσμα δυνάμεων αντίδρασης επαφής, $\mathbf{g}$: διάνυσμα κενωμάτων στις περιοχές επαφής.

Μετά τη λύση του συστήματος, οι τάσεις στα στοιχεία υπολογίζονται μέσω της παραγώγου των συναρτήσεων σχήματος και των μετατοπίσεων των κόμβων:

$$\sigma = \mathbf{DB}\mathbf{u}_{e}$$

όπου $\mathbf{D}$: πίνακας ιδιοτήτων υλικού (π.χ. για ισοτροπικά υλικά περιλαμβάνει το $E$ και το $\nu$), $\mathbf{B}$: πίνακας παραγώγων συναρτήσεων σχήματος, $\mathbf{u}_{e}$: διάνυσμα μετατοπίσεων του στοιχείου.

#### Πλεονεκτήματα
- Ανάλυση ανωμαλιών και πολύπλοκων γεωμετριών
- Διαχειρίζεται εύκολα πολλαπλές περιοχές επαφής ή πολύπλοκες συνθήκες φόρτισης
- Παρέχει λεπτομερή κατανομή τάσεων σε όλο το σώμα
- Μειώνει την ανάγκη για πειραματικές διαδικασίες

#### Μειονεκτήματα
- Υψηλές υπολογιστικές απαιτήσεις
- Χρονοβόρα προετοιμασία (πλέγμα, συνθήκες επαφής)
- Προβλήματα σύγκλισης σε μεγάλες παραμορφώσεις
- Περιορισμένη εφαρμογή σε πραγματικό χρόνο

### Μοντελοποίηση επαφής με τη χρήση Στοιχείων Συνόρων (BEM)

#### Περιγραφή
Η Μέθοδος των Στοιχείων Συνόρων (Boundary Element Method, BEM) αποτελεί ισχυρή αριθμητική τεχνική για την επίλυση προβλημάτων μηχανικής επαφής, εστιάζοντας στη διακριτοποίηση μόνο των ορίων (επιφανειών) των σωμάτων, αντί για ολόκληρο τον όγκο. Αυτό επιτρέπει σημαντική μείωση του πλήθους των βαθμών ελευθερίας όταν το πρόβλημα αφορά άπειρους ή ημι-άπειρους ελαστικούς χώρους, όπως οι ράγες.

#### Μαθηματικό Υπόβαθρο
Η βασική εξίσωση της BEM για ελαστική επαφή προέρχεται από τη θεμελιώδη λύση της ελαστικότητας (Green's function) και δίνεται ως ολοκληρωτική σχέση μεταξύ μετατοπίσεων και τάσεων στην επιφάνεια:

$$c(\mathbf{\xi})u_{j}(\mathbf{\xi}) + \int_{\Gamma}^{}T_{ij}(\mathbf{x},\mathbf{\xi})u_{j}(\mathbf{x})\, d\Gamma(\mathbf{x}) = \int_{\Gamma}^{}U_{ij}(\mathbf{x},\mathbf{\xi})t_{j}(\mathbf{x})\, d\Gamma(\mathbf{x})$$

όπου $u_{j}(\mathbf{x})$: μετατόπιση στο σημείο $\mathbf{x}$ σε διεύθυνση $j$, $t_{j}(\mathbf{x})$: επιφανειακή τάση, $U_{ij}$, $T_{ij}$: πυρηνικές (θεμελιώδεις) λύσεις για το πρόβλημα ελαστικότητας, $\Gamma$: το σύνορο (επιφάνεια) του σώματος, $c(\mathbf{\xi})$: συντελεστής που εξαρτάται από τη γεωμετρία.

Για την επαφή τροχού-ράγας, το πρόβλημα περιορίζεται στην επιφάνεια επαφής, όπου εφαρμόζονται συνθήκες μη διείσδυσης (non-penetration) και ισορροπίας των δυνάμεων.

#### Πλεονεκτήματα
- Υψηλή ακρίβεια για επιφανειακές δυνάμεις
- Μειωμένος υπολογιστικός όγκος (μόνο επιφάνειες)
- Εφαρμογή σε άπειρους ή ημι-άπειρους χώρους (όπως ράγες)
- Ταχύτερη επίλυση σε απλές γεωμετρίες

#### Μειονεκτήματα
- Περιορισμός σε επιφανειακά προβλήματα (όχι όγκος)
- Δυσκολία σε μη-γραμμικά ή ανισοτροπικά συστήματα
- Μεγάλη υπολογιστική απαίτηση για πολύπλοκες επιφάνειες
- Περιορισμένη εφαρμογή σε προβλήματα με έντονη τριβή

### Μοντελοποίηση επαφής με τη χρήση εικονικής διείσδυσης

#### Περιγραφή
Η ανάγκη για ταχύτατους και αποδοτικούς υπολογισμούς δυνάμεων επαφής, ειδικά σε δυναμικά συστήματα πολλαπλής επαφής (multi-body dynamics), οδήγησε στην ανάπτυξη μεθόδων που βασίζονται στην εικονική διείσδυση (penetration depth). Σε αυτήν την προσέγγιση, η δύναμη επαφής εκτιμάται ως συνάρτηση του βάθους επικάλυψης μεταξύ των δύο σωμάτων που αλληλεπιδρούν. Το penetration depth ορίζεται ως το ελάχιστο διάνυσμα μετατόπισης που απαιτείται ώστε τα σώματα να μην επικαλύπτονται.

#### Οπτικό Υλικό
<figure>
<img src="media/image2.png" style="width:4.04028in;height:2.81597in" alt="Analysis of Wheel-Roller Contact and Comparison with the Wheel-Rail Case | Urban Rail Transit" />
<figcaption>Εικόνα 2.1.5.1 Προσέγγιση περιοχής επαφής με εικονική διείσδυση</figcaption>
</figure>

#### Μαθηματικό Υπόβαθρο
Για δύο σώματα $A$ και $B$, το penetration depth $d_{p}$ ορίζεται ως:

$$d_{p} = \min_{\delta\mathbf{x}}\left\{ \parallel \delta\mathbf{x} \parallel :(A + \delta\mathbf{x}) \cap B = \varnothing \right\}$$

Δηλαδή, το ελάχιστο μέτρο μετατόπισης που απαιτείται ώστε οι επιφάνειες να μην επικαλύπτονται.

Η δύναμη επαφής $F_{c}$ συχνά υπολογίζεται ως συνάρτηση του penetration depth με μια απλή γραμμική ή μη γραμμική σχέση τύπου ελατηρίου (spring law):

$$F_{c} = k_{p} \cdot d_{p}^{n}$$

όπου $k_{p}$: συντελεστής "σκληρότητας" επαφής (contact stiffness), $n$: εκθετικός παράγοντας (συνήθως $n = 1$ για γραμμική, $n = 1.5$ για ημι-Hertz κλπ).

Σε δυναμικές προσομοιώσεις συχνά προστίθεται και αποσβεστική δύναμη (damping):

$$F_{tot} = k_{p} \cdot d_{p}^{n} + c_{p} \cdot {\dot{d}}_{p}$$

όπου $c_{p}$ είναι ο συντελεστής απόσβεσης και ${\dot{d}}_{p}$ η ταχύτητα διείσδυσης.

Στις non-Hertz μεθόδους, οι υπολογισμοί γίνονται με εμπειρικούς ή αριθμητικούς τρόπους, λαμβάνοντας υπόψη πολύπλοκες γεωμετρίες, μη γραμμικές ιδιότητες υλικών ή ανομοιομορφίες επιφανειών.

Η semi-Hertz μέθοδος διατηρεί τη βασική φόρμουλα του Hertz αλλά επιτρέπει τροποποιήσεις στους παραμέτρους ώστε να λαμβάνονται υπόψη πραγματικές συνθήκες:

$$F_{c} = k_{Hertz,mod} \cdot d_{p}^{3/2}$$

όπου ο $k_{Hertz,mod}$ προσαρμόζεται ανάλογα με τη γεωμετρία ή τις τοπικές ιδιότητες των επιφανειών.

#### Πλεονεκτήματα
- Ταχύτητα υπολογισμών
- Ευελιξία σε γεωμετρία και υλικά
- Εφαρμογή σε πολλαπλά σημεία επαφής
- Προσαρμοστικότητα (non-Hertz, semi-Hertz)

#### Μειονεκτήματα
- Έλλειψη φυσικής θεμελίωσης
- Ανάγκη βαθμονόμησης παραμέτρων
- Περιορισμένη ακρίβεια σε σύνθετες συνθήκες
- Δεν παρέχει κατανομή εσωτερικών τάσεων

## Μαθηματική και Πρακτική Θεμελίωση Αλγορίθμων Ανίχνευσης Επαφής

Σε αυτή την ενότητα παρουσιάζονται οι βασικές κατηγορίες αλγορίθμων ανίχνευσης επαφής (contact detection) που χρησιμοποιούνται στη μηχανική, τη δυναμική πολλαπλών σωμάτων (MBS), FEM, BEM και στη βιομηχανία.

### Hertzian Contact Detection (Σημειακή/Ελλειπτική Επαφή)

#### Περιγραφή
Ο κλασικός αλγόριθμος που βασίζεται στη θεωρία του Hertz για την εύρεση μιας ελλειπτικής περιοχής επαφής. Εφαρμόζεται ιδανικά σε απλές, λείες γεωμετρίες.

#### Μαθηματικό Υπόβαθρο
1. Εύρεση πλησιέστερων σημείων:

$$(x_{A}^{*},x_{B}^{*}) = arg\min_{x_{A} \in S_{A},x_{B} \in S_{B}} \parallel x_{A} - x_{B} \parallel$$

2. Οι τοπικές ακτίνες καμπυλότητας $R_{x},R_{y}$ υπολογίζονται στη θέση επαφής.
3. Το contact patch:

$$A = \pi ab$$

#### Πλεονεκτήματα
- Πολύ γρήγορος και αποδοτικός υπολογισμός για απλές (σφαιρικές/ελλειπτικές) γεωμετρίες
- Παρέχει αναλυτική λύση για το μέγεθος και τη θέση της περιοχής επαφής
- Χρησιμοποιείται ευρέως ως βάση για θεωρητικές και πρακτικές εφαρμογές τροχού-ράγας

#### Μειονεκτήματα
- Δεν εφαρμόζεται σε πολύπλοκες/ακανόνιστες γεωμετρίες
- Αγνοεί επιφανειακές ανωμαλίες και πολλαπλά σημεία επαφής
- Δεν λαμβάνει υπόψη τριβή ή διατμητικές τάσεις

### Penalty/Penetration Detection (Εικονική Διείσδυση)

#### Περιγραφή
Μία ευρέως χρησιμοποιούμενη αριθμητική μέθοδος όπου η δύναμη επαφής υπολογίζεται αναλογικά με το βαθύτερο σημείο διείσδυσης (overlap) μεταξύ δύο σωμάτων.

#### Μαθηματικό Υπόβαθρο
1. Για κάθε σημείο $i$ του σώματος $A$, υπολογίζεις:

$$d_{i} = \min_{y \in S_{B}} \parallel x_{i} - y \parallel$$

2. Αν $d_{i} < 0$ (αρνητικό gap), υπάρχει επαφή στο $x_{i}$.
3. Η δύναμη επαφής:

$$F_{i} = k_{p} \cdot |d_{i}|^{n}$$

όπου $k_{p}$ σταθερά penalty, $n$ εκθέτης (συνήθως $1 \leq n \leq 1.5$).

#### Πλεονεκτήματα
- Εύκολη υλοποίηση και ταχύτατος υπολογισμός, κατάλληλος για real-time εφαρμογές
- Εφαρμόζεται σε οποιαδήποτε γεωμετρία και πλήθος σημείων επαφής
- Παρέχει ευελιξία στη διαχείριση πολύπλοκων φαινομένων και πολλαπλών επαφών

#### Μειονεκτήματα
- Απαιτεί επιλογή παραμέτρων penalty που επηρεάζουν τη σταθερότητα και φυσικότητα των δυνάμεων
- Δεν παρέχει κατανομή εσωτερικών τάσεων (μόνο συνολική δύναμη)
- Μπορεί να εμφανίσει αριθμητικά artefacts (π.χ. stickiness, spikes)

### Node-to-Surface και Surface-to-Surface Methods

#### Περιγραφή
Ακριβείς μέθοδοι ανίχνευσης επαφής που βασίζονται στον υπολογισμό ελάχιστων αποστάσεων μεταξύ κόμβων και επιφανειών ή μεταξύ επιφανειών.

#### Μαθηματικό Υπόβαθρο
- Για κάθε κόμβο $i$:

$$g_{i} = \min_{y \in S_{B}} \parallel x_{i} - y \parallel$$

- Επαφή αν $g_{i} < \varepsilon$ (tolerance).

Surface-to-surface:
- Ψάχνεις για το ελάχιστο ζεύγος σημείων $(x,y)$ με:

$$g = \min_{x \in S_{A},\, y \in S_{B}} \parallel x - y \parallel$$

#### Πλεονεκτήματα
- Πολύ ακριβής ανίχνευση σημείου και βάθους επαφής, ανεξάρτητα από τη γεωμετρία
- Κατάλληλη για FEM/BEM και high-fidelity μοντελοποίηση
- Επιτρέπει εντοπισμό πολλαπλών επαφών σε πολύπλοκα σχήματα

#### Μειονεκτήματα
- Υπολογιστικά απαιτητική, ειδικά για μεγάλα πλέγματα/πολλά σώματα
- Απαιτεί καλό αλγόριθμο ελαχιστοποίησης απόστασης
- Μπορεί να δημιουργήσει αριθμητικές δυσκολίες σε πολύπλοκες/σύνθετες επιφάνειες

### Bounding Volume Hierarchies (AABB, OBB)

#### Περιγραφή
Μέθοδοι που χρησιμοποιούν απλά γεωμετρικά σχήματα (κουτιά, σφαίρες) για την αποδοτική ανίχνευση πιθανών επαφών σε μεγάλα συστήματα.

#### Μαθηματικό Υπόβαθρο
Για δύο AABB $A$, $B$ με όρια $\lbrack x_{\min}^{A},x_{\max}^{A}\rbrack$ κτλ:

$$\text{Επαφή} \Leftrightarrow \left\{ \begin{matrix}
x_{\min}^{A} \leq x_{\max}^{B}\mspace{6mu} \land \mspace{6mu} x_{\max}^{A} \geq x_{\min}^{B} \\
y_{\min}^{A} \leq y_{\max}^{B}\mspace{6mu} \land \mspace{6mu} y_{\max}^{A} \geq y_{\min}^{B} \\
z_{\min}^{A} \leq z_{\max}^{B}\mspace{6mu} \land \mspace{6mu} z_{\max}^{A} \geq z_{\min}^{B}
\end{matrix} \right.\ $$

OBB (Oriented Bounding Box): Ο έλεγχος γίνεται σε περιστρεφόμενο σύστημα αξόνων.

#### Πλεονεκτήματα
- Εξαιρετικά γρήγορη ανίχνευση επαφής σε μεγάλα συστήματα (ιδανικό για broad phase)
- Πολύ αποδοτική με λίγους ψευδώς θετικούς ελέγχους αν οριστεί σωστά η γεωμετρία
- Κλιμακώνεται εύκολα με αύξηση των σωμάτων

#### Μειονεκτήματα
- Δεν ανιχνεύει το πραγματικό σημείο ή βάθος επαφής - απαιτεί narrow phase
- Δημιουργεί ψευδώς θετικά (false positives) που πρέπει να φιλτραριστούν
- Πιο σύνθετη υλοποίηση για OBB, ειδικά με μεταβαλλόμενη γεωμετρία

### Spatial Hashing / Voxelization

#### Περιγραφή
Μέθοδος που χωρίζει τον χώρο σε τρισδιάστατα κελιά (voxels) για γρήγορη αναζήτηση γειτονικών σωμάτων.

#### Μαθηματικό Υπόβαθρο
- Για κάθε σημείο $x$:

$$\text{Voxel index:}\mspace{6mu}\mspace{6mu} i_{x} = \left\lfloor \frac{x - x_{\min}}{\Delta x} \right\rfloor$$

όπου $\Delta x$ το μέγεθος του voxel.
- Κάθε αντικείμενο "ανήκει" στους voxels όπου βρίσκεται.
- Επαφή αν δύο αντικείμενα ανήκουν στον ίδιο voxel.

#### Πλεονεκτήματα
- Εξαιρετικά γρήγορη αναζήτηση γειτονικών σωμάτων (neighbor search)
- Κατάλληλη για πολύπλοκα ή πολυπληθή συστήματα (granular, crowd, κ.λπ.)
- Ευέλικτη για δυναμικές σκηνές με συνεχείς κινήσεις

#### Μειονεκτήματα
- Εξαρτάται από το μέγεθος voxel - μπορεί να χαθεί ακρίβεια ή να αυξηθούν ψευδώς θετικά
- Μειωμένη αποτελεσματικότητα σε αντικείμενα με μεγάλο εύρος διαστάσεων
- Απαιτεί σωστή παραμετροποίηση και tuning για βέλτιστη επίδοση

### FEM/BEM Contact Detection

#### Περιγραφή
Εξελιγμένες μέθοδοι ανίχνευσης επαφής που ενσωματώνονται απευθείας σε προσομοιώσεις πεπερασμένων στοιχείων ή στοιχείων συνόρων.

#### Μαθηματικό Υπόβαθρο
- Για κάθε κόμβο $i$:

$$g_{i} = (x_{i} - y_{i}) \cdot n_{i}$$

όπου $y_{i}$ το πλησιέστερο σημείο στην αντίθετη επιφάνεια, $n_{i}$ η τοπική κατεύθυνση.
- Επαφή αν $g_{i} < 0$.

#### Πλεονεκτήματα
- Πολύ υψηλή ακρίβεια και δυνατότητα ανάλυσης πολύπλοκων γεωμετριών
- Υποστηρίζει πολλαπλές ταυτόχρονες επαφές και μη-γραμμικές καταστάσεις
- Ιδανική για αναλυτική διερεύνηση και ανάλυση τάσεων

#### Μειονεκτήματα
- Πολύ μεγάλες υπολογιστικές απαιτήσεις (CPU, μνήμη)
- Απαιτεί σύνθετο pre-processing (πλέγμα, επιφάνειες, κ.λπ.)
- Δεν είναι κατάλληλη για real-time εφαρμογές ή προσομοίωση μεγάλων συστημάτων

### GJK (Gilbert-Johnson-Keerthi) Algorithm (για κυρτά σχήματα)

#### Περιγραφή
Γενικός αλγόριθμος για τον έλεγχο τομής και ελάχιστης απόστασης μεταξύ δύο κυρτών πολυέδρων.

#### Μαθηματικό Υπόβαθρο
- Δομείται το Minkowski difference $A \ominus B$
- Επαφή αν το origin βρίσκεται εντός του $A \ominus B$
- Αν όχι, η ελάχιστη απόσταση του origin από το σύνορο αντιστοιχεί στην ελάχιστη απόσταση μεταξύ $A$ και $B$

#### Πλεονεκτήματα
- Γενικός αλγόριθμος για κυρτά πολύεδρα
- Ταχύτατος και αξιόπιστος για real-time προσομοιώσεις
- Κλιμακώνεται καλά σε δυναμικές σκηνές με πολλά σώματα

#### Μειονεκτήματα
- Περιορίζεται σε κυρτές γεωμετρίες (convex only)
- Πιο περίπλοκη υλοποίηση από απλά bounding volumes
- Για μη-κυρτά αντικείμενα απαιτεί decomposition σε κυρτά τμήματα

## Πολλαπλή Δυναμική (Multibody Dynamics) --- Θεωρητικό Υπόβαθρο

Η Πολλαπλή Δυναμική (Multibody Dynamics, MBD) μελετά τη συμπεριφορά μηχανικών συστημάτων που αποτελούνται από πολλά διασυνδεδεμένα σώματα (άκαμπτα ή/και ελαστικά), με στόχο τη μαθηματική περιγραφή, ανάλυση και προσομοίωση της κίνησής τους υπό την επίδραση δυνάμεων, περιορισμών και συναρτήσεων επαφής.

### Κινηματική και Κινητική Θεμελίωση

#### Θέση και Προσανατολισμός Σωμάτων
Κάθε σώμα στο χώρο περιγράφεται από:
- Γενικευμένες συντεταγμένες θέσης $r_{i} \in \mathbb{R}^{3}$: Θέση του κέντρου μάζας του σώματος $i$
- Γενικευμένες συντεταγμένες προσανατολισμού $A_{i} \in SO(3)$: Μήτρα προσανατολισμού (ή quaternions, Euler γωνίες)

Το διάνυσμα θέσης στο σώμα $i$ για σημείο με τοπικές συντεταγμένες $s_{i}$ είναι:

$$r = r_{i} + A_{i}s_{i}$$

#### Ταχύτητα και Επιτάχυνση
Ο χρόνος παράγωγος της θέσης δίνει την ταχύτητα:

$$\dot{r} = {\dot{r}}_{i} + {\dot{A}}_{i}s_{i}$$

Όπου η παράγωγος της μήτρας προσανατολισμού σχετίζεται με το διανυσματικό γινόμενο της γωνιακής ταχύτητας $\omega_{i}$:

$${\dot{A}}_{i} = A_{i}{\widetilde{\omega}}_{i}$$

όπου ${\widetilde{\omega}}_{i}$ είναι το αντισυμμετρικό μητρώο της γωνιακής ταχύτητας.

#### Εξισώσεις Κίνησης
Για ένα σύστημα $N$ σωμάτων με γενικευμένες συντεταγμένες $q \in \mathbb{R}^{n}$, οι εξισώσεις κίνησης (με περιορισμούς) είναι:

$$M(q)\,\ddot{q} + h(q,\dot{q},t) = Q_{ext} + Q_{c}$$

όπου:
- $M(q)$: Μήτρα μάζας (συμπεριλαμβάνει αδρανειακές ιδιότητες όλων των σωμάτων)
- $h(q,\dot{q},t)$: Όροι Coriolis, φυγόκεντρες, αποσβεστήρες, κ.λπ.
- $Q_{ext}$: Εξωτερικές δυνάμεις και ροπές
- $Q_{c}$: Γενικευμένες δυνάμεις περιορισμών (λόγω joints, επαφών κτλ.)

Για αλγεβρικούς περιορισμούς $g(q,t) = 0$:

$$M(q)\,\ddot{q} + h(q,\dot{q},t) = Q_{ext} + Q_{c}$$
$$g(q,t) = 0$$

##### Εξαγωγή μέσω Lagrange (με περιορισμούς):

$$\frac{d}{dt}\left( \frac{\partial L}{\partial\dot{q}} \right) - \frac{\partial L}{\partial q} = Q_{ext} + G_{q}^{T}\lambda$$

όπου $L = T - V$ (κινητική μείον δυναμική ενέργεια), $G_{q} = \partial g/\partial q$ η Ιακωβιανή των περιορισμών, $\lambda$ οι Λαγγρανζιανοί πολλαπλασιαστές (δυνάμεις/ροπές περιορισμών).

### Περιορισμοί (Constraints) --- Joints

#### Περιγραφή
Οι περιορισμοί (constraints) εκφράζουν τις σχέσεις που επιβάλλουν οι αρθρώσεις στην κίνηση των σωμάτων, μειώνοντας τους διαθέσιμους βαθμούς ελευθερίας.

#### Πίνακας: Κύριες Αρθρώσεις (Joints)

| Joint type    | Περιγραφή                          | Επιτρέπει (DoF) | Περιορίζει (DoF) |
|---------------|------------------------------------|-----------------|------------------|
| Revolute      | Περιστροφή γύρω από 1 άξονα        | 1 περιστροφή    | 5 (όλες οι μεταφορές + 2 στροφές) |
| Prismatic     | Μετάθεση κατά 1 άξονα              | 1 μετάθεση      | 5 (2 μεταφορές + 3 στροφές) |
| Spherical     | Τρεις περιστροφές (μπάλα-υποδοχή)  | 3 περιστροφές   | 3 (όλες οι μεταφορές) |
| Fixed         | Καμία σχετική κίνηση (συγκολλημένο)| 0               | 6                |
| Cylindrical   | 1 περιστροφή + 1 μετάθεση γύρω από κοινό άξονα | 2 (1 περιστροφή, 1 μετάθεση) | 4 |
| Planar        | Κίνηση σε επίπεδο, περιστροφή σε κάθετο άξονα | 3 (2 μεταφορές, 1 περιστροφή) | 3 |

### Επίλυση Εξισώσεων --- Ολοκληρωτές (Integrators)

#### Περιγραφή
Οι εξισώσεις DAEs είναι συχνά stiff (δυσκαμπτες) και απαιτούν implicit αριθμητικούς ολοκληρωτές.

#### Μαθηματικό Υπόβαθρο
Ο DSTIFF χρησιμοποιεί το σχήμα Backward Differentiation Formula (BDF). Για κάθε βήμα χρόνου $n + 1$:

- Γενική εξίσωση ολοκλήρωσης:
  $F(q_{n + 1},{\dot{q}}_{n + 1},t_{n + 1}) = 0$ με
  ${\dot{q}}_{n + 1} = \sum_{k = 0}^{s}a_{k}q_{n + 1 - k}$ όπου $h$ το
  βήμα χρόνου, $a_{k}$ συντελεστές του BDF, και $s$ η τάξη του σχήματος.
- Επαναληπτική επίλυση (Newton-Raphson):
  $q_{n + 1}^{(i + 1)} = q_{n + 1}^{(i)} - J^{- 1}F(q_{n + 1}^{(i)},{\dot{q}}_{n + 1}^{(i)},t_{n + 1})$
- Εφαρμογή περιορισμών: Σε κάθε βήμα επαληθεύονται οι αλγεβρικοί
  περιορισμοί ($g(q_{n + 1},t_{n + 1}) = 0$).